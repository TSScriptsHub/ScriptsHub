$LicMode = Read-Host("Please enter the licensing mode this server will run under.  Type '2' for Per Device, Type '4' for Per User")
$obj = gwmi -namespace "Root/CIMV2/TerminalServices" Win32_TerminalServiceSetting
$LicStatChange = $obj.ChangeMode($LicMode)
$LicServUpdate = $obj.SetSpecifiedLicenseServerList("127.0.0.1")
if($LicStatChange.ReturnValue -eq 0)
{
    Write-Host("Licensing Mode Set Successfully")
}
else
{
    Write-Host("ERROR:  Licensing Mode Could NOT Be Set")
}
if($LicServUpdate.ReturnValue -eq 0)
{
    Write-Host("Licensing Server Set To Localhost (127.0.0.1)")
}
else
{
    Write-Host("ERROR:  Licensing Server Could NOT Be Set")
}
Start-Process "licmgr.exe"

# SIG # Begin signature block
# MIIMLQYJKoZIhvcNAQcCoIIMHjCCDBoCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUmV0V8o5RD9gpo4fDdL9JQKig
# 3VmgggmWMIIEmTCCA4GgAwIBAgIQcaC3NpXdsa/COyuaGO5UyzANBgkqhkiG9w0B
# AQsFADCBqTELMAkGA1UEBhMCVVMxFTATBgNVBAoTDHRoYXd0ZSwgSW5jLjEoMCYG
# A1UECxMfQ2VydGlmaWNhdGlvbiBTZXJ2aWNlcyBEaXZpc2lvbjE4MDYGA1UECxMv
# KGMpIDIwMDYgdGhhd3RlLCBJbmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkx
# HzAdBgNVBAMTFnRoYXd0ZSBQcmltYXJ5IFJvb3QgQ0EwHhcNMTMxMjEwMDAwMDAw
# WhcNMjMxMjA5MjM1OTU5WjBMMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMdGhhd3Rl
# LCBJbmMuMSYwJAYDVQQDEx10aGF3dGUgU0hBMjU2IENvZGUgU2lnbmluZyBDQTCC
# ASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJtVAkwXBenQZsP8KK3TwP7v
# 4Ol+1B72qhuRRv31Fu2YB1P6uocbfZ4fASerudJnyrcQJVP0476bkLjtI1xC72Ql
# WOWIIhq+9ceu9b6KsRERkxoiqXRpwXS2aIengzD5ZPGx4zg+9NbB/BL+c1cXNVeK
# 3VCNA/hmzcp2gxPI1w5xHeRjyboX+NG55IjSLCjIISANQbcL4i/CgOaIe1Nsw0Rj
# gX9oR4wrKs9b9IxJYbpphf1rAHgFJmkTMIA4TvFaVcnFUNaqOIlHQ1z+TXOlScWT
# af53lpqv84wOV7oz2Q7GQtMDd8S7Oa2R+fP3llw6ZKbtJ1fB6EDzU/K+KTT+X/kC
# AwEAAaOCARcwggETMC8GCCsGAQUFBwEBBCMwITAfBggrBgEFBQcwAYYTaHR0cDov
# L3QyLnN5bWNiLmNvbTASBgNVHRMBAf8ECDAGAQH/AgEAMDIGA1UdHwQrMCkwJ6Al
# oCOGIWh0dHA6Ly90MS5zeW1jYi5jb20vVGhhd3RlUENBLmNybDAdBgNVHSUEFjAU
# BggrBgEFBQcDAgYIKwYBBQUHAwMwDgYDVR0PAQH/BAQDAgEGMCkGA1UdEQQiMCCk
# HjAcMRowGAYDVQQDExFTeW1hbnRlY1BLSS0xLTU2ODAdBgNVHQ4EFgQUV4abVLi+
# pimK5PbC4hMYiYXN3LcwHwYDVR0jBBgwFoAUe1tFz6/Oy3r9MZIaarbzRutXSFAw
# DQYJKoZIhvcNAQELBQADggEBACQ79degNhPHQ/7wCYdo0ZgxbhLkPx4flntrTB6H
# novFbKOxDHtQktWBnLGPLCm37vmRBbmOQfEs9tBZLZjgueqAAUdAlbg9nQO9ebs1
# tq2cTCf2Z0UQycW8h05Ve9KHu93cMO/G1GzMmTVtHOBg081ojylZS4mWCEbJjvx1
# T8XcCcxOJ4tEzQe8rATgtTOlh5/03XMMkeoSgW/jdfAetZNsRBfVPpfJvQcsVncf
# hd1G6L/eLIGUo/flt6fBN591ylV3TV42KcqF2EVBcld1wHlb+jQQBm1kIEK3Osgf
# HUZkAl/GR77wxDooVNr2Hk+aohlDpG9J+PxeQiAohItHIG4wggT1MIID3aADAgEC
# AhBxPMPDk0djvTbhld/ELzViMA0GCSqGSIb3DQEBCwUAMEwxCzAJBgNVBAYTAlVT
# MRUwEwYDVQQKEwx0aGF3dGUsIEluYy4xJjAkBgNVBAMTHXRoYXd0ZSBTSEEyNTYg
# Q29kZSBTaWduaW5nIENBMB4XDTE1MDEyOTAwMDAwMFoXDTE3MDEyODIzNTk1OVow
# fDELMAkGA1UEBhMCVVMxEDAOBgNVBAgTB0dlb3JnaWExEzARBgNVBAcUCkFscGhh
# cmV0dGExGTAXBgNVBAoUEE1peG9mbHlkaWFuLCBMTEMxEDAOBgNVBAsUB0lUIERl
# cHQxGTAXBgNVBAMUEE1peG9mbHlkaWFuLCBMTEMwggEiMA0GCSqGSIb3DQEBAQUA
# A4IBDwAwggEKAoIBAQCtXnSwEtHruw0xBgiA9xp2t9i88QiZRFLjwhE14b2kUkic
# UkVBp6+Y5KdQG87uKi6BYRO62w8mwxYH5S6xu31qIYBlMnK4SCQUjFjbZIE+8pDl
# z6HQeHqF6pD36lUd417QfyYZRElo8g6gEe0HqXtwSnzecv4PMvOPdh52XtO0xVCZ
# 6pt2O5GMLNXHj3WsS1ERVWiDAZMZcC8CP5SJTUgmPndZxJXYZLC/thi3xg6IlNbu
# 5TVHKammIA91ENFwGvW6Pk31vuVa7kNVj+KINxm1a7wEUxVnvMpKWsgBnGkEhMmn
# N8crM3pquQx0rEZHKFMXvmARbvWQIor1semOIVcFAgMBAAGjggGhMIIBnTAJBgNV
# HRMEAjAAMB8GA1UdIwQYMBaAFFeGm1S4vqYpiuT2wuITGImFzdy3MB0GA1UdDgQW
# BBTHyyE84r9DCF+OHUfDfRcoyBNOWjArBgNVHR8EJDAiMCCgHqAchhpodHRwOi8v
# dGwuc3ltY2IuY29tL3RsLmNybDAOBgNVHQ8BAf8EBAMCB4AwEwYDVR0lBAwwCgYI
# KwYBBQUHAwMwcwYDVR0gBGwwajBoBgtghkgBhvhFAQcwAjBZMCYGCCsGAQUFBwIB
# FhpodHRwczovL3d3dy50aGF3dGUuY29tL2NwczAvBggrBgEFBQcCAjAjDCFodHRw
# czovL3d3dy50aGF3dGUuY29tL3JlcG9zaXRvcnkwHQYDVR0EBBYwFDAOMAwGCisG
# AQQBgjcCARYDAgeAMFcGCCsGAQUFBwEBBEswSTAfBggrBgEFBQcwAYYTaHR0cDov
# L3RsLnN5bWNkLmNvbTAmBggrBgEFBQcwAoYaaHR0cDovL3RsLnN5bWNiLmNvbS90
# bC5jcnQwEQYJYIZIAYb4QgEBBAQDAgQQMA0GCSqGSIb3DQEBCwUAA4IBAQB2cRsN
# S9OE98B7yMmXnHC4vKFb7kczspp4pVvA1/Gp3zLfsnDKF7iVWQ4W7eojIzS2fXmn
# Z6kY7cZJ3/9VP9Bl6BLxByBrCUbGcM3vXEFVWoJcQ1KpgCIj9DU7bs7kM0bK5aSf
# pZ7MZmJ2rKbv718ilgQ//Vm8PHj112KcBW7TLQnBztHodCw7qnA2RjnCUK44FI6O
# ID1XMkN4RPUHcVT1XIelOYD9oXj1BdCHzR4OLVYTsQkMfaphrBk5nbz4OOHCsNbl
# LoUsw4dekbVZqcI5Q+8Y46cEk5/swdqUyrXpwnFbVBLjve69uaz1MXuzGKn6cYHp
# rVSqIS6rUdRumRo8MYICATCCAf0CAQEwYDBMMQswCQYDVQQGEwJVUzEVMBMGA1UE
# ChMMdGhhd3RlLCBJbmMuMSYwJAYDVQQDEx10aGF3dGUgU0hBMjU2IENvZGUgU2ln
# bmluZyBDQQIQcTzDw5NHY7024ZXfxC81YjAJBgUrDgMCGgUAoHgwGAYKKwYBBAGC
# NwIBDDEKMAigAoAAoQKAADAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgor
# BgEEAYI3AgELMQ4wDAYKKwYBBAGCNwIBFjAjBgkqhkiG9w0BCQQxFgQUE2UAPZvv
# XI7JS5WDWGb6pYo5azAwDQYJKoZIhvcNAQEBBQAEggEAcLxVhktD3M/ZNCPyrpsS
# OKOKU/n2WLoKELuucZRn0JTqT1g1FRooULOzKPUsWORudJLX+HxWIx1oQo58SeM8
# 7SawslL04qcDrmNfOyDqbPA390Kc+ntWrTgBxs7CVfdtnpZ6fBCU1ufaqK90NSkP
# rYp7PIPb+6u0xD3+dlMWe/+8Qn8xgblMQeMj44NFFWecvA7o2xLN/3XzyoGgdh+c
# PIm1J2tkkZiKPMtoU5HWoco7nLsoAqSCvOedHcDCoS3DblbBj0Kukpd760XXywFE
# ZDbYaTFAedo0VzgoSZJKU47VDP7yNrKWS36wORgTJt8zN6XShN5vzCPLSnD3Ci9J
# Kw==
# SIG # End signature block
